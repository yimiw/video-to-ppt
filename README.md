# VideoToPPT ğŸ¬â¡ï¸ğŸ“Š

<div align="center">

**æ™ºèƒ½è§†é¢‘è½¬PPTå·¥å…· - åŸºäº WebAV å’Œ FFmpeg çš„ç°ä»£åŒ–è§£å†³æ–¹æ¡ˆ**

[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![Next.js](https://img.shields.io/badge/Next.js-000000?style=for-the-badge&logo=next.js&logoColor=white)](https://nextjs.org/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind_CSS-38B2AC?style=for-the-badge&logo=tailwind-css&logoColor=white)](https://tailwindcss.com/)
[![WebAV](https://img.shields.io/badge/WebAV-FF6B35?style=for-the-badge&logo=webassembly&logoColor=white)](https://github.com/hughfenghen/WebAV)
[![FFmpeg](https://img.shields.io/badge/FFmpeg-007808?style=for-the-badge&logo=ffmpeg&logoColor=white)](https://ffmpeg.org/)

[ğŸš€ åœ¨çº¿ä½“éªŒ](https://video.liwenkai.fun) | [ğŸ“– ä½¿ç”¨æ•™ç¨‹](#-ä½¿ç”¨æ•™ç¨‹) | [ğŸ› ï¸ æœ¬åœ°éƒ¨ç½²](#æœ¬åœ°éƒ¨ç½²) | [ğŸ¤ è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

</div>

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | æè¿° |
|------|------|
| ğŸ¥ **å±å¹•å½•åˆ¶** | å®æ—¶å±å¹•å½•åˆ¶ï¼Œæ”¯æŒç³»ç»ŸéŸ³é¢‘å’Œéº¦å…‹é£ |
| ğŸ“ **æœ¬åœ°è§†é¢‘å¤„ç†** | ä¸Šä¼ æœ¬åœ°è§†é¢‘æ–‡ä»¶è¿›è¡Œæ™ºèƒ½åˆ†æ |
| ğŸ§  **æ™ºèƒ½å¸§æå–** | åŸºäºå·®å¼‚æ£€æµ‹ç®—æ³•è‡ªåŠ¨æå–å…³é”®å¸§ |
| ğŸ“Š **PPTç”Ÿæˆ** | ä¸€é”®å¯¼å‡ºä¸º PowerPoint æ¼”ç¤ºæ–‡ç¨¿ |
| ğŸ–¼ï¸ **å›¾ç‰‡é¢„è§ˆ** | å¯æ»šåŠ¨æŸ¥çœ‹æ‰€æœ‰æå–çš„å›¾ç‰‡ |
| ğŸ“¥ **æ‰¹é‡ä¸‹è½½** | æ”¯æŒå•å¼ æˆ–æ‰¹é‡ä¸‹è½½æ‰€æœ‰å›¾ç‰‡ |

### ğŸš€ æŠ€æœ¯äº®ç‚¹

- **ğŸ¨ ç°ä»£åŒ–UI**: ç°ä»£è®¾è®¡é£æ ¼ï¼Œæ·±è‰²ä¸»é¢˜ï¼Œæµç•…åŠ¨ç”»
- **âš¡ é«˜æ€§èƒ½å¤„ç†**: WebCodecs + WebAssembly æä¾›åŸç”Ÿçº§æ€§èƒ½
- **ğŸ”’ éšç§ä¿æŠ¤**: çº¯å®¢æˆ·ç«¯å¤„ç†ï¼Œæ•°æ®ä¸ç¦»å¼€æµè§ˆå™¨
- **ğŸ“± å“åº”å¼è®¾è®¡**: å®Œç¾é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- **ğŸ›ï¸ æ™ºèƒ½ç®—æ³•**: åŠ¨æ€é˜ˆå€¼è®¡ç®—ï¼Œè‡ªåŠ¨è¿‡æ»¤ç›¸ä¼¼å¸§
- **ğŸ›¡ï¸ ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript ç±»å‹ç³»ç»Ÿ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æ¡†æ¶
- **[Next.js 15](https://nextjs.org/)** - Reactæ¡†æ¶ï¼ŒApp Router
- **[TypeScript](https://www.typescriptlang.org/)** - ç±»å‹å®‰å…¨çš„JavaScript
- **[Tailwind CSS v4](https://tailwindcss.com/)** - åŸå­åŒ–CSSæ¡†æ¶
- **[Shadcn/ui](https://ui.shadcn.com/)** - é«˜è´¨é‡UIç»„ä»¶åº“

### è§†é¢‘å¤„ç†
- **[WebAV](https://github.com/hughfenghen/WebAV)** - ç°ä»£Webè§†é¢‘å¤„ç†åº“
- **[FFmpeg.wasm](https://github.com/ffmpegwasm/ffmpeg.wasm)** - æµè§ˆå™¨ä¸­çš„FFmpeg
- **[WebCodecs API](https://developer.mozilla.org/en-US/docs/Web/API/WebCodecs_API)** - åŸç”Ÿè§†é¢‘ç¼–è§£ç 

### UI/UXå¢å¼º
- **[Lucide React](https://lucide.dev/)** - ç²¾ç¾çš„å›¾æ ‡åº“
- **[Radix UI](https://www.radix-ui.com/)** - æ— æ ·å¼UIåŸºç¡€ç»„ä»¶
- **[Class Variance Authority](https://cva.style/)** - ç»„ä»¶å˜ä½“ç®¡ç†

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Node.js** 18.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **pnpm** 9.x æˆ– **npm** 10.x
- **ç°ä»£æµè§ˆå™¨** (Chrome 102+, Edge 102+)

### æœ¬åœ°éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/liwenka1/video-to-ppt.git
cd video-to-ppt

# 2. å®‰è£…ä¾èµ–
pnpm install
# æˆ–è€…ä½¿ç”¨ npm
npm install

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
# æˆ–è€…ä½¿ç”¨ npm
npm run dev

# 4. æ‰“å¼€æµè§ˆå™¨è®¿é—®
open http://localhost:3000
```

### ç”Ÿäº§éƒ¨ç½²

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
pnpm start
```

## ğŸ® ä½¿ç”¨æ•™ç¨‹

### 1. å±å¹•å½•åˆ¶æ¨¡å¼

1. **å‡†å¤‡å½•åˆ¶**: ç‚¹å‡»"å‡†å¤‡å½•åˆ¶"æŒ‰é’®
2. **é€‰æ‹©å±å¹•**: é€‰æ‹©è¦å½•åˆ¶çš„å±å¹•æˆ–çª—å£
3. **å¼€å§‹å½•åˆ¶**: ç‚¹å‡»"å¼€å§‹å½•åˆ¶"å¼€å§‹æ•è·
4. **æ™ºèƒ½æˆªå›¾**: ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹ç”»é¢å˜åŒ–å¹¶æˆªå›¾
5. **ç”ŸæˆPPT**: å½•åˆ¶å®Œæˆåä¸€é”®ç”ŸæˆPPT

### 2. æœ¬åœ°è§†é¢‘å¤„ç†

1. **ä¸Šä¼ è§†é¢‘**: æ‹–æ‹½æˆ–é€‰æ‹©æœ¬åœ°è§†é¢‘æ–‡ä»¶
2. **æ ¼å¼è½¬æ¢**: è‡ªåŠ¨è½¬æ¢ä¸ºå…¼å®¹æ ¼å¼ï¼ˆå¦‚éœ€è¦ï¼‰
3. **æ™ºèƒ½åˆ†æ**: æå–å…³é”®å¸§ï¼Œè¿‡æ»¤ç›¸ä¼¼å†…å®¹
4. **é¢„è§ˆç¡®è®¤**: æ»šåŠ¨æŸ¥çœ‹æ‰€æœ‰æå–çš„å›¾ç‰‡
5. **ä¸‹è½½è¾“å‡º**: ç”ŸæˆPPTæˆ–æ‰¹é‡ä¸‹è½½å›¾ç‰‡

### 3. å›¾ç‰‡ç®¡ç†åŠŸèƒ½ âœ¨

- **å®Œæ•´é¢„è§ˆ**: å¯æ»šåŠ¨æŸ¥çœ‹æ‰€æœ‰æå–çš„å›¾ç‰‡
- **æ‰¹é‡ä¸‹è½½**: ç‚¹å‡»"ä¸‹è½½å…¨éƒ¨"æŒ‰é’®è·å–ZIPæ–‡ä»¶
- **å•å¼ æ“ä½œ**: æ‚¬æµ®å›¾ç‰‡æ˜¾ç¤ºä¸‹è½½å’Œé¢„è§ˆæŒ‰é’®
- **ç¼–å·æ ‡è¯†**: æ¯å¼ å›¾ç‰‡æ˜¾ç¤ºåºå·ä¾¿äºå®šä½

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
video-to-ppt/
â”œâ”€â”€ ğŸ“ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ ğŸ“ (site)/              # ç½‘ç«™é¡µé¢ç»„
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx         # é¦–é¡µ
â”‚   â”œâ”€â”€ ğŸ“ local-video/         # æœ¬åœ°è§†é¢‘å¤„ç†é¡µé¢
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx         # æœ¬åœ°è§†é¢‘ä¸Šä¼ ä¸å¤„ç†
â”‚   â”œâ”€â”€ ğŸ“ screen-recording/    # å±å¹•å½•åˆ¶é¡µé¢
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx         # å±å¹•å½•åˆ¶ä¸æˆªå›¾
â”‚   â”œâ”€â”€ ğŸ“„ layout.tsx           # åº”ç”¨æ ¹å¸ƒå±€
â”‚   â””â”€â”€ ğŸ“„ globals.css          # å…¨å±€æ ·å¼
â”œâ”€â”€ ğŸ“ components/              # å¯å¤ç”¨ç»„ä»¶
â”‚   â””â”€â”€ ğŸ“ ui/                  # Shadcn/ui ç»„ä»¶
â”œâ”€â”€ ğŸ“ lib/                     # æ ¸å¿ƒé€»è¾‘åº“
â”‚   â”œâ”€â”€ ğŸ“„ video-processing.ts  # è§†é¢‘å¤„ç†æ ¸å¿ƒç®—æ³•
â”‚   â”œâ”€â”€ ğŸ“„ video-diagnostics.ts # è§†é¢‘è¯Šæ–­ä¸å…¼å®¹æ€§æ£€æŸ¥
â”‚   â”œâ”€â”€ ğŸ“„ ppt-generation.ts    # PPTç”Ÿæˆé€»è¾‘
â”‚   â””â”€â”€ ğŸ“„ utils.ts             # é€šç”¨å·¥å…·å‡½æ•°
â”œâ”€â”€ ğŸ“ data/                    # æ•°æ®é…ç½®
â”‚   â””â”€â”€ ğŸ“„ resume.tsx           # é¡¹ç›®ä¿¡æ¯ä¸å…ƒæ•°æ®
â”œâ”€â”€ ğŸ“ styles/                  # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ ğŸ“„ globals.css          # å…¨å±€CSSæ ·å¼
â”œâ”€â”€ ğŸ“ public/                  # é™æ€èµ„æº
â”œâ”€â”€ ğŸ“„ next.config.ts           # Next.jsé…ç½®
â”œâ”€â”€ ğŸ“„ tailwind.config.ts       # Tailwind CSSé…ç½®
â””â”€â”€ ğŸ“„ package.json             # é¡¹ç›®ä¾èµ–é…ç½®
```

## ğŸ”§ æ ¸å¿ƒç®—æ³•

### æ™ºèƒ½å·®å¼‚æ£€æµ‹

```typescript
/**
 * è®¡ç®—ä¸¤ä¸ªå›¾åƒå¸§ä¹‹é—´çš„å·®å¼‚åº¦
 * ä½¿ç”¨äº®åº¦å€¼å·®å¼‚çš„å‡æ–¹æ ¹ä½œä¸ºåˆ¤æ–­æ ‡å‡†
 */
function calculateImageDifference(
  imgData1: ImageData,
  imgData2: ImageData
): number {
  let sumOfSquares = 0;
  const length = imgData1.data.length;

  for (let i = 0; i < length; i += 4) {
    // RGBè½¬äº®åº¦å€¼ (Rec. 709æ ‡å‡†)
    const luminance1 = 0.2126 * imgData1.data[i] +
                      0.7152 * imgData1.data[i + 1] +
                      0.0722 * imgData1.data[i + 2];

    const luminance2 = 0.2126 * imgData2.data[i] +
                      0.7152 * imgData2.data[i + 1] +
                      0.0722 * imgData2.data[i + 2];

    const diff = luminance1 - luminance2;
    sumOfSquares += diff * diff;
  }

  return Math.sqrt(sumOfSquares / (length / 4));
}
```

### åŠ¨æ€é˜ˆå€¼è®¡ç®—

```typescript
/**
 * é¢„å¤„ç†è§†é¢‘è®¡ç®—æœ€ä½³å·®å¼‚é˜ˆå€¼
 * åŸºäºè§†é¢‘å†…å®¹åŠ¨æ€è°ƒæ•´ï¼Œæé«˜å…³é”®å¸§æå–å‡†ç¡®æ€§
 */
async function preprocessVideo(
  video: HTMLVideoElement,
  canvas: HTMLCanvasElement
): Promise<number> {
  const duration = video.duration;
  const sampleCount = Math.min(50, Math.max(20, Math.floor(duration / 10)));
  const differences: number[] = [];

  for (let i = 0; i < sampleCount - 1; i++) {
    // è®¡ç®—é‡‡æ ·å¸§é—´å·®å¼‚
    const time1 = (duration / sampleCount) * i;
    const time2 = (duration / sampleCount) * (i + 1);

    const diff = await calculateFrameDifference(video, canvas, time1, time2);
    differences.push(diff);
  }

  // ä½¿ç”¨ä¸­ä½æ•°ä½œä¸ºåŸºå‡†é˜ˆå€¼
  differences.sort((a, b) => a - b);
  const medianDiff = differences[Math.floor(differences.length / 2)];

  // è®¾ç½®åˆç†çš„é˜ˆå€¼èŒƒå›´ [10, 60]
  return Math.max(10, Math.min(medianDiff, 60));
}
```

## ğŸ¨ è®¾è®¡ç‰¹è‰²

### ç°ä»£è®¾è®¡é£æ ¼

- **ğŸ¯ åŠŸèƒ½ä¼˜å…ˆ**: æ¸…æ™°çš„è§†è§‰å±‚æ¬¡ï¼Œç›´è§‚çš„æ“ä½œæµç¨‹
- **ğŸŒ™ æ·±è‰²ä¸»é¢˜**: ä¸“ä¸šçš„æ·±è‰²é…è‰²æ–¹æ¡ˆï¼Œå‡å°‘çœ¼éƒ¨ç–²åŠ³
- **ğŸŒˆ æ¸å˜èƒŒæ™¯**: è“è‰²/ç´«è‰²/é’è‰²åŠ¨æ€æ¸å˜
- **ğŸ’ ç»ç’ƒæ€æ•ˆæœ**: backdrop-blur å’ŒåŠé€æ˜å…ƒç´ 
- **âš¡ æµç•…åŠ¨ç”»**: è‡ªç„¶çš„è¿‡æ¸¡æ•ˆæœå’Œäº¤äº’åé¦ˆ

### å“åº”å¼è®¾è®¡

- **ğŸ“± ç§»åŠ¨ä¼˜å…ˆ**: Mobile-first è®¾è®¡åŸåˆ™
- **ğŸ–¥ï¸ æ¡Œé¢é€‚é…**: å¤§å±å¹•ä¸‹çš„æœ€ä½³ä½“éªŒ
- **â™¿ æ— éšœç¢æ”¯æŒ**: æ”¯æŒé”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨
- **ğŸ›ï¸ çŠ¶æ€åé¦ˆ**: å®æ—¶çš„å¤„ç†çŠ¶æ€å’Œè¿›åº¦æ˜¾ç¤º

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

<details>
<summary><strong>ğŸ”§ FFmpeg å¯¼å…¥é”™è¯¯</strong></summary>

**é”™è¯¯ä¿¡æ¯**: `Module not found: Can't resolve '@ffmpeg/ffmpeg'`

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// next.config.ts ä¸­çš„é…ç½®
const nextConfig = {
  webpack: (config) => {
    config.resolve.alias = {
      ...config.resolve.alias,
      '@ffmpeg/ffmpeg': '@ffmpeg/ffmpeg/dist/esm/index.js',
    };
    return config;
  },
};
```
</details>

<details>
<summary><strong>ğŸŒ WebAV ç±»å‹é”™è¯¯</strong></summary>

**é”™è¯¯ä¿¡æ¯**: `Cannot find module '@webav/av-cliper'`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç¡®ä¿å®‰è£…æ­£ç¡®ç‰ˆæœ¬
pnpm add @webav/av-cliper@latest
```
</details>

<details>
<summary><strong>ğŸ›¡ï¸ SharedArrayBuffer é”™è¯¯</strong></summary>

**é”™è¯¯ä¿¡æ¯**: `SharedArrayBuffer is not defined`

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿åœ¨ HTTPS ç¯å¢ƒä¸‹è¿è¡Œï¼Œæˆ–ä½¿ç”¨ Chrome å¼€å¯ç›¸å…³ç‰¹æ€§:
```bash
# å¼€å‘ç¯å¢ƒå¯åŠ¨å‚æ•°
chrome --enable-features=SharedArrayBuffer
```
</details>

<details>
<summary><strong>ğŸ¥ è§†é¢‘æ ¼å¼ä¸æ”¯æŒ</strong></summary>

**è§£å†³æ–¹æ¡ˆ**: å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶è½¬æ¢æ ¼å¼ï¼Œæ”¯æŒçš„è¾“å…¥æ ¼å¼:
- MP4, WebM, MOV, AVI, MKV, WMV, FLV, 3GP, OGV
</details>

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼æ— è®ºæ˜¯æŠ¥å‘ŠBugã€æå‡ºæ–°åŠŸèƒ½å»ºè®®ï¼Œè¿˜æ˜¯æäº¤ä»£ç ã€‚

### ğŸ› ï¸ å¼€å‘æŒ‡å—

```bash
# 1. Fork é¡¹ç›®å¹¶å…‹éš†
git clone https://github.com/your-username/video-to-ppt.git

# 2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/amazing-feature

# 3. æäº¤æ›´æ”¹
git commit -m 'feat: add amazing feature'

# 4. æ¨é€åˆ†æ”¯
git push origin feature/amazing-feature

# 5. åˆ›å»º Pull Request
```

### ğŸ“ ä»£ç è§„èŒƒ

- **TypeScript**: ä½¿ç”¨ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥
- **ESLint**: éµå¾ªé¡¹ç›®ESLinté…ç½®
- **Prettier**: ç»Ÿä¸€ä»£ç æ ¼å¼åŒ–
- **Conventional Commits**: è§„èŒƒåŒ–æäº¤ä¿¡æ¯

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT](./LICENSE) è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](./LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®çš„çµæ„Ÿæ¥æºäº [video2ppt.com](https://video2ppt.com/)ï¼Œæ„Ÿè°¢ä»–ä»¬æä¾›çš„ä¼˜ç§€åˆ›æ„å’Œè§£å†³æ–¹æ¡ˆã€‚

## ğŸ“Š é¡¹ç›®çŠ¶æ€

![GitHub Stars](https://img.shields.io/github/stars/liwenka1/video-to-ppt?style=social)
![GitHub Forks](https://img.shields.io/github/forks/liwenka1/video-to-ppt?style=social)
![GitHub Issues](https://img.shields.io/github/issues/liwenka1/video-to-ppt)
![GitHub Pull Requests](https://img.shields.io/github/issues-pr/liwenka1/video-to-ppt)

---

<div align="center">

**ğŸŒŸ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ª Starï¼**

[â¬†ï¸ å›åˆ°é¡¶éƒ¨](#videotoppt-ï¸)

Made with â¤ï¸ by [liwenka1](https://github.com/liwenka1)

</div>
